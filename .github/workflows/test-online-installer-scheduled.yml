name: test-online-installer

on:
  schedule:
    - cron:  '10 2 * * *'

jobs:
  test-installer:
    name: Test Online installer - Scheduled
    runs-on: windows-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v2
      - name: Download Installer
        run:  Invoke-WebRequest https://github.com/espressif/idf-installer/releases/download/online-2.6-beta-36/esp-idf-tools-setup-online-2.6-beta-36.exe -OutFile installer.exe
        shell: pwsh
      - name: Run installer
        run: ./src/PowerShell/Install-Idf.ps1 -IdfVersion "master" -Components "ide/powershell/desktop,ide/cmd/desktop"
        shell: pwsh
      - name: Build blink
        run: ./src/PowerShell/Test-IdfCmd.ps1 -IdfShortVersion "4.4"
        shell: pwsh
